{% extends "biblio/base.html" %}

{% load static %}

{% block extrahead %}
{% if data %}
<script
			  src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
			  integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8="
			  crossorigin="anonymous"></script>

<link href="https://unpkg.com/tabulator-tables@4.5.3/dist/css/tabulator.min.css" rel="stylesheet">
<link href="https://unpkg.com/tabulator-tables@4.5.3/dist/css//bootstrap/tabulator_bootstrap4.min.css" rel="stylesheet">
<script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.5.3/dist/js/tabulator.min.js"></script>
<script type="text/javascript">
var data = {{data|safe}};

function on_rowclick(e, row) {
    window.open(row['_row']['data']['id'], '_blank');
    //window.location.href = row['_row']['data']['id']
}

$( document ).ready(function() {
    var table = new Tabulator("#entries-table", {
        //height:$(window).height()-200, // set height of table (in CSS or here), this enables the Virtual DOM and improves render speed dramatically (can be any valid css height value)
        data:data, //assign data to table
        layout:"fitDataStretch", //fit columns to width of table (optional)
        columns:[ //Define Table Columns
            {title:"Titel", field:"title", headerFilter:"input", headerFilterPlaceholder:"Suche nach ..."},
            {title:"Autoren", field:"authors", headerFilter:"input", headerFilterPlaceholder:"Autor.."},
            {title:"Jahr", field:"year"},
            {title:"Tags", field:"tags", headerSort:false}
        ],
        rowClick:on_rowclick,
        pagination:"local",
        paginationSize:10,
        paginationSizeSelector:[10, 25, 50, 100],
    });
});
</script>   

{% endif %}

{% endblock %}

{% block content %}
<div class="w3-container">
    <div id="entries-table"></div>
</div>
{% endblock %}